---
title: "LSDi Analysis"
author: "Sara Gosline"
date: "`r Sys.Date()`"
output: html_document
---

This document does supplemental analysis outside the paper evaluating the role of LSD1 inhibition on FLT3 and RAS mutants. 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
source("../util/synapseUtil.R")
library(dplyr)
syn<-synapseLogin()

if(!exists('dataLoaded')){
  source("../load_beatAML_data.R")
  dataLoaded=TRUE
  phos<-load_beataml_phospho_data()
  prot<-load_beataml_global_data()
  trans<-load_beat_aml_transcript_data()
  gene<-load_beataml_genomic_data()
  
}

clin <- read.table(syn$get('syn26642974')$path,quote='"',header=T)%>%
  select(labId,FLT3_ITDCall)%>%
  distinct()

funcData <- querySynapseTable("syn25830473")

```

## Identify LDSi AUC

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}

library(ggplot2)

redData<-funcData%>%
  dplyr::select(labId='lab_id',auc,inhibitor)%>%
  mutate(auc=as.numeric(auc))

single.agent<-redData%>%
  subset(inhibitor%in%c('Trametinib (GSK1120212)','Quizartinib (AC220)','GSK-2879552'))


redData<-single.agent%>%
  left_join(clin)%>%
  tidyr::replace_na(list(FLT3_ITDCall='Negative'))

pvals<-grep('Positive',redData$FLT3_ITDCall)
redData[pvals,'FLT3_ITDCall']<-rep('Positive',length(pvals))
redData%>%ggplot(aes(x=FLT3_ITDCall,y=auc,col=inhibitor,fill=inhibitor))+geom_boxplot()

redData%>%
 subset(inhibitor%in%c('Quizartinib (AC220)','GSK-2879552'))%>%
  ggplot(aes(y=auc,x=labId,col=inhibitor))+geom_point()



redData%>%
 subset(inhibitor%in%c('Trametinib (GSK1120212)','GSK-2879552'))%>%
  ggplot(aes(y=auc,x=labId,col=inhibitor))+geom_point()
```



We can evaluate teh signle agents


```{r double agent}
quiz.double.agent<-intersect(grep('GSK2879552',redData$inhibitor),grep('Quizartinib',redData$inhibitor))
                             
tram.double.agent<-intersect(grep('GSK2879552',redData$inhibitor),grep('Trametinib',redData$inhibitor))

double.agent<-redData[c(quiz.double.agent,tram.double.agent),]


dredData<-double.agent%>%
  left_join(clin)%>%
  tidyr::replace_na(list(FLT3_ITDCall='Negative'))

pvals<-grep('Positive',dredData$FLT3_ITDCall)
dredData[pvals,'FLT3_ITDCall']<-rep('Positive',length(pvals))
dredData%>%ggplot(aes(x=FLT3_ITDCall,y=auc,col=inhibitor,fill=inhibitor))+geom_boxplot()


fredData<-rbind(single.agent,double.agent)%>%
  left_join(clin)%>%
  tidyr::replace_na(list(FLT3_ITDCall='Negative'))

pvals<-grep('Positive',fredData$FLT3_ITDCall)
fredData[pvals,'FLT3_ITDCall']<-rep('Positive',length(pvals))


fredData%>%subset(inhibitor%in%c('GSK-2879552','Quizartinib (AC220)','Quizartinib - GSK2879552'))%>%
  ggplot(aes(x=FLT3_ITDCall,y=auc,col=inhibitor,fill=inhibitor))+geom_boxplot()

ggsave('flt3_combo_LSDi.pdf')

```

##  Now do RAS

How does the AUC vary for RAS treatment

```{r pressure, echo=FALSE}
ras.mut<-subset(gene,symbol%in%c("KRAS",'NRAS'))%>%
  dplyr::select(symbol,labId)%>%
  right_join(fredData)%>%
  subset(inhibitor%in%c('GSK-2879552','Trametinib - GSK2879552','Trametinib (GSK1120212)'))%>%
  tidyr::replace_na(list(symbol='WT'))

ras.mut%>%ggplot(aes(x=symbol,y=auc,col=inhibitor,fill=inhibitor))+geom_boxplot()

ggsave("AUCof_RAS_LSDicombos.pdf")

```
Not really a lot of difference in trametinib.

## Predictors of drug response in FLT3 wt vs mutant

IF we break down the patients by 
